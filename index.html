<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸­å›½èªæ¤œå®š</title>
  <style>
    * {
      font-size: 20px;
    }


    .header {
      position: fixed;
      top: 0px;
      left: 0px;
      z-index: 10;
      background-color: lemonchiffon;
      width: 100%;


    }

    .header p {
      padding-left: 100px;

    }

    .question-no {
      font-size: 16px;
    }


    .clkBtn {
      cursor: pointer;
      user-select: none;
    }

    .divFlex {
      display: flex;
      padding-left: 20px;
    }

    .sheetSelect {
      padding-top: 0px;
    }

    .speed {
      padding-top: 0px;
    }

    .dataContent {
      padding-top: 130px;

      display: block;
    }

    .dataDisplay {
      display: block;
    }

    .dataNone {
      display: none;
    }

    .member {
      margin-bottom: 20px;
    }

    .member span {

      border: 1px solid pink;
      border-radius: 10%;
      display: inline-block;
      margin-right: 10px;
      cursor: pointer;
    }

    .hanyu {
      display: block;
      font-weight: bold;
      margin-top: 0;
      margin-bottom: 0;
      cursor: pointer;
      user-select: none;
    }

    .hanyuDisplay {
      display: block;
      font-weight: bold;
    }

    .hanyuNoDisplay {
      display: none;
    }

    .pinyin {
      display: block;
      font-weight: bold;
      margin-top: 0;
      margin-bottom: 0;
    }

    .pinyinDisplay {
      display: block;
      font-weight: bold;
    }

    .pinyinNoDisplay {
      display: none;
    }

    .japanese {
      display: block;

      margin-top: 0;
      margin-bottom: 0;

    }

    .japaneseDisplay {
      display: block;
      margin-top: 0;
      margin-bottom: 0;
    }

    .japaneseNoDisplay {
      display: none;
    }

    .japaneseGroupX {
      display: flex;
    }

    .japaneseGroup {
      margin: 0;
    }

    .japaneseKnone {
      display: none;
    }

    .japaneseKBlock {
      display: block;
      margin: 0;
    }

    .inputNoDisplay {
      display: none;
    }


    .spanBack1 {
      background-color: black;

      color: black;
    }

    .spanBack2 {
      background-color: red;

      color: red;
    }

    .spanBack3 {
      background-color: pink;

      color: pink;
    }

    .spanBack4 {
      background-color: yellow;

      color: yellow;
    }

    .spanBackNone {
      display: none;
    }

    .spanBackCansel {
      color: black;
      background-color: transparent;

    }

    .spanBackCansel::after {
      display: none;

    }


    .spanBack1:after {


      color: white;

      content: 'A';
      z-index: 289;
    }

    .spanBack2:after {


      color: white;

      content: 'B';
      z-index: 289;
    }

    .spanBack3:after {


      color: white;

      content: 'C';
      z-index: 289;
    }

    .spanBack4:after {


      color: blue;

      content: 'D';
      z-index: 289;
    }



    .pFontSize {
      font-size: 12px;
    }

    .pFontSizeNoDisplay {
      display: none;
    }

    #comment {
      font-size: 32px;
    }

    #baiFen {
      font-size: 32px;
      color: red;
    }

    #check-next {
      background-color: cyan;
      border-radius: 8px;
      width: 100px;
      height: 40px;
      text-align: center;
      line-height: 40px;
      cursor: pointer;
      user-select: none;
      margin-left: 40px;
      box-shadow: 0 4px #7a0000;
    }

    #check-next:hover {
      opacity: 0.8;
    }

    #check-next:active {
      box-shadow: 0 1px #7a0000;
      transform: translateY(3px);
    }

    .divSpeak {
      background-color: cyan;
      border-radius: 20%;
      width: 100px;
      height: 40px;
      text-align: center;
      line-height: 40px;
      margin-bottom: 20px;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 4px #7a0000;

    }

    .divSpeak:active {
      box-shadow: 0 1px #7a0000;
      transform: translateY(3px);
    }

    .totalGrade {
      padding-left: 30px;
      padding-top: 120px;
      display: block;
      animation: 03s fadeIn;
    }

    .totalGradeDisplay {
      display: block;
    }

    .totalGradeNoDisplay {
      display: none;
    }

    .lPaternNoDisplay {
      display: none;
    }

    .lPaternAnswer {
      cursor: pointer;
      user-select: none;

    }

    #comment {
      margin: 5px 2px;
    }

    #reTry {
      background-color: pink;
      border-radius: 8px;
      width: 400px;
      height: 40px;
      text-align: center;
      line-height: 40px;
      cursor: pointer;
      user-select: none;
      margin-top: 30px;
      box-shadow: 0 4px #7a0000;

    }

    #reTry:hover {
      opacity: 0.8;
    }

    #reTry:active {
      box-shadow: 0 1px #7a0000;
      transform: translateY(3px);
    }

    .onseiStart {
      display: inline-block;
      cursor: pointer;
      border-color: pink;
      border-radius: 8px;
      box-shadow: 0 4px #7a0000;
    }

    .status {
      font-size: 14px;
    }

    .statusNodisplay {
      display: none;
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: translateY(-10px);

      }

      100% {
        opacity: 1;
        transform: none;
      }

    }
  </style>
</head>

<body>
  <div class="header">
    <p>aiä¸­å›½èªã‚¯ã‚¤ã‚ºã€€ã€€ã€€ã€€<button id="timer">æ™‚é–“è¨ˆæ¸¬</button></p>

    <div class="divFlex">
      <div class="sheetSelect">

        <label for="sheet-select">ã‚·ãƒ¼ãƒˆé¸æŠï¼š</label><select id="sheet-select" name="sheetSelect"></select>
      </div>
      <div class="speed">
        <label for="speech-Speed">ã€€ã€€éŸ³å£°ã‚¹ãƒ”ãƒ¼ãƒ‰:</label>

        <select name="speechSpeed" id="speech-Speed">
          <option value="1.0">1.0</option>
          <option value="0.9">0.9</option>
          <option value="0.8">0.8</option>
          <option value="0.7">0.7</option>
          <option value="0.6">0.6</option>
          <option value="0.5">0.5</option>
          <option value="1.1">1.1</option>
          <option value="1.2">1.2</option>
          <option value="1.3">1.3</option>
          <option value="1.4">1.4</option>
          <option value="1.5">1.5</option>
          <option value="1.6">1.6</option>
          <option value="1.7">1.7</option>
          <option value="1.8">1.8</option>
          <option value="1.9">1.9</option>
          <option value="2.0">2.0</option>

        </select>
      </div>
    </div>
  </div>
  <div id="main">
    <div id="container">

    </div>


  </div>
  <!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script> -->
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
  <!-- <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script> -->


  <!-- <script src="./get_post_gss.js"></script> -->
  <script>
    let osAndroid = false;
    let ua = window.navigator.userAgent.toLocaleLowerCase();
    if (ua.indexOf("android") !== -1) {
      osAndroid = true;
      console.log(ua);
      console.log(ua.indexOf("android"));
    }
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€€åˆ—ã€€å®šæ•°å®šç¾©
    const idxNo = 0;
    const idxPattern = 1;
    const idxHanyu = 2;
    const idxPinyin = 3;
    const idxRiyu = 4; // æ—¥æœ¬èªè¨³
    const idxSpan = 5;  // Fåˆ—
    //
    // ã€‚ã€€ï¼Ÿã€€å®šæ•°å®šç¾©
    const constWenhao = 'ï¼Ÿ';
    const constWenhao2 = '?';
    const constKuten = 'ã€‚';
    const cstKanma = "ï¼Œ";
    let cssIndex = 0;
    let sheetIndex2;  // ã‚·ãƒ¼ãƒˆç•ªå· for ãƒ‘ã‚¿ãƒ¼ãƒ³O,P,Q
    let swButton = false;  // false: check  true: next

    let main;
    let container;
    let checknext;
    let comment;
    let seikaiSu;    // ã‚·ãƒ¼ãƒˆã”ã¨ã®æ­£è§£æ•°
    let startTime;
    let endTime;
    let hAnswer; //ã€€Hã‚¿ã‚¤ãƒ—ã®æœ€çµ‚éŸ³å£°å…¥åŠ›
    let micBtn;  // éŸ³å£°ãƒœã‚¿ãƒ³
    let wStatus;  // éŸ³å£°ã®status
    let wShowResult;  // éŸ³å£°ã®å‡ºåŠ›çµæœ
    let kNihongo1;
    let kNihongo2;
    let hanyuTab; // C,Gãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸­å›½èªã®é…åˆ—
    let saveQuestions;  // questionsã®ä¿å­˜ for Oãƒ‘ã‚¿ãƒ¼ãƒ³

    //
    // Declare webkitSpeechRecognition
    window.SpeechRecognition = window.SpeechRecognition || webkitSpeechRecognition;
    var recognition = new webkitSpeechRecognition();

    // Web Speech API Configuration
    // Language
    recognition.lang = 'zh-CN';
    // Show Progress
    recognition.interimResults = true;
    // Continuous recognition
    recognition.continuous = true;

    //
    // let onseiStart = document.getElementById('onseiStart');

    // let show_result = document.getElementById('show_result');
    recognition.onsoundstart = function () {

      wStatus.innerHTML = "Recognizing";

      // document.getElementsByClassName('dataDisplay').querySelector('.status').innerHTML = "Recognizing";
    };
    recognition.onnomatch = function () {
      // document.getElementById('status').innerHTML = "Try again";
      wStatus.innerHTML = "Try again";
      // fncOnseiNyuryokuRetry();
    };
    recognition.onerror = function (event) {
      // document.getElementById('status').innerHTML = "ERROR";
      wStatus.innerHTML = "ERROR";
      console.log("Speech recognition error detected: " + event.error); console.log("Additional information: " + event.message);
      // fncOnseiNyuryokuRetry();
    };

    recognition.onsoundend = function () {
      // document.getElementById('status').innerHTML = "Stopped";
      wStatus.innerHTML = "Stopped";

    };
    function fncOnseiNyuryoku(para1) {
      if (para1.innerHTML === 'ã‚¹ãƒˆãƒƒãƒ—') {
        recognition.stop();
        para1.innerHTML = 'éŸ³å£°å…¥åŠ›';
        return;
      }
      var classDataDisplay = document.getElementsByClassName('dataDisplay');
      witem0 = classDataDisplay.item(0);
      var wchild = witem0.children;
      wStatus = wchild.item(10);
      wShowResult = wchild.item(11);  //  class="show_result"

      // para1.style.display = 'none';
      para1.innerHTML = 'ã‚¹ãƒˆãƒƒãƒ—';
      hAnswer = ' ';
      recognition.start();
      // this.disabled = true;

    }

    recognition.onresult = function (event) {

      var results = event.results;
      // show_result.innerHTML = '<div>' + results[0][0].transcript + '</div>';

      for (var i = event.resultIndex; i < results.length; i++) {
        if (results[i].isFinal) {

          wShowResult.innerHTML += '<div>' + results[i][0].transcript + '</div>';
          console.log(`hAnswer=${results[i][0].transcript}`);
          if (results[i][0].transcript !== '') {

            hAnswer = results[i][0].transcript;
          }
        } else {

        }


      }
    }


    const timer = document.getElementById('timer');
    timer.addEventListener('click', () => {
      startTime = Date.now(); // é–‹å§‹æ™‚é–“
      timer.style.display = 'none';


    });
    main = document.getElementById('main');
    container = document.getElementById('container');
    // document.addEventListener('DOMContentLoaded', function () {
    var tdOLD;//2023/08/24 è¿½åŠ 
    let questions;
    function speakData(param1, param2) {

      // if (param1 instanceof HTMLTableCellElement) {
      const td = param1;

      var uttr = new SpeechSynthesisUtterance(td.textContent);
      uttr.lang = "zh-CN"
      uttr.rate = speakSpeedRate();
      speechSynthesis.cancel();
      speechSynthesis.speak(uttr);

      // }

    }
    function speakDataNpatern(hanyuString) {

      // if (param1 instanceof HTMLTableCellElement) {
      
      var uttr = new SpeechSynthesisUtterance(hanyuString);
      uttr.lang = "zh-CN"
      uttr.rate = speakSpeedRate();
      speechSynthesis.cancel();
      speechSynthesis.speak(uttr);

      // }

    }
    function speakDataX(param1, param2) {

      const quizPattern = questions[cssIndex][idxPattern];
      const td = param1;
      let answerGroup = document.querySelectorAll('.answer');;
      let questionGroup = document.querySelectorAll('.question');;
      let answerSpans = answerGroup[cssIndex];
      let questionSpans = questionGroup[cssIndex];
      // let sheetDatas;
      if (quizPattern !== 'E') {
        var uttr = new SpeechSynthesisUtterance(setHanyuBunkai(td.textContent));
        uttr.lang = "zh-CN"
        uttr.rate = speakSpeedRate();
        speechSynthesis.cancel();
        speechSynthesis.speak(uttr);

      }

      if (param1.parentElement.classList.contains('answer')) {
        questionSpans.appendChild(param1);



      } else {
        if (quizPattern === 'I' || quizPattern === 'J' || quizPattern === 'K' || quizPattern === 'M' || quizPattern === 'N' || quizPattern === 'O' || quizPattern === 'P' || quizPattern === 'Q' || quizPattern === 'R' || quizPattern === 'S' || quizPattern === 'T') {
          console.log(answerSpans.children.length);
          if (answerSpans.children.length > 1) {
            questionSpans.appendChild(answerSpans.children[1]);

          }
          answerSpans.appendChild(param1);

        } else {

          answerSpans.appendChild(param1);


        }

      }



    }
    function speakData2() {
      let l = 1;
      // if (param1 instanceof HTMLTableCellElement) {

      const hanyuWords = setHanyuBunkai(questions[cssIndex][idxHanyu]);
      var uttr = new SpeechSynthesisUtterance(hanyuWords);
      uttr.lang = "zh-CN"
      uttr.rate = speakSpeedRate();
      speechSynthesis.cancel();
      speechSynthesis.speak(uttr);

      // }

    }

    // speak speed èª¿æ•´ 2023-06-22
    function speakSpeedRate() {

      let select = document.querySelector('[name="speechSpeed"]');

      var rate = parseFloat(select.selectedOptions[0].value);
      return rate;

    }
    // window.onload = function () {

    const END_POINT = "https://script.google.com/macros/s/AKfycbzd6BMFMjRR6KUsThFjSm0NiPTXe6Llt4fvFDbE47WIjC5V4gvsEYAQ1Ry4oWC_8770/exec";
    //ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼ˆã‚¿ãƒ–ï¼‰ã®ç•ªå·

    // 2023-07-03 ãƒ•ã‚¡ãƒ¼ã‚¦ã‚§ã‚¤ã‚¹ãƒãƒ›å¯¾å¿œå¤‰æ›´

    // 23-06-13 -äº”åéŸ³ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚----------------------

    let select = document.querySelector('[name="sheetSelect"]');

    select.onchange = event => {
      var selIndex = select.selectedIndex;
      sheetIndex = selIndex;  // ã“ã‚Œã¯ä¸è¦ã‹ã‚‚ã—ã‚Œãªã„
      sheetIndex2 = selIndex;
      console.log(select.selectedIndex);



      container.remove();
      container = document.createElement('div');
      container.setAttribute('id', 'container');
      main.appendChild(container);
      questions = structuredClone(sheetDatas[selIndex + 1]);
      renderQuestions(questions);
      iniCSSSet();
      cssIndex = 0;
      swButton = false;
    }




    const sheetSelector = document.getElementById("sheet-select");

    // const wrapper = document.getElementById("wrapper");




    getFromGAS();//èµ·å‹•æ™‚ã®ãƒ‡ãƒ¼ã‚¿å–å¾—

    //----------- ä»¥ä¸‹ã€é–¢æ•°å®šç¾©--------------------------
    // return ContentService.createTextOutput(JSON.stringify(allData));
    // ã—ãŸã‚‚ã®ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ã€‚
    function getFromGAS() {

      $.ajax({
        type: "GET",
        url: END_POINT,
        // data: { sheetNo: SHEET_NO }

      }).done((result) => {        // æˆåŠŸã—ãŸæ™‚ã®å‡¦ç†
        console.log("get done:" + result);
        setSheetNames(JSON.parse(result)[0]);

        // getFromGAS(1);
        sheetDatas = JSON.parse(result);
        sheetIndex2 = 0; // ç¬¬1ç•ªç›®ã®ã‚·ãƒ¼ãƒˆ
        questions = structuredClone(sheetDatas[1]);
        renderQuestions(questions);

        iniCSSSet();
      }).fail((error) => {  // å¤±æ•—ã—ãŸæ™‚ã®å‡¦ç†
        alert('Error:' + JSON.stringify(error));

      }).always((data) => {// å¸¸ã«ã‚„ã‚‹å‡¦ç†
        // do something
        // enableControlElements();
      });
    }


    function setSheetNames(sheetNamesArray) {
      sheetSelector.innerHTML = "";
      document.createElement('option')
      sheetNamesArray.forEach((sheetName, index) => {
        let option = document.createElement('option');
        option.setAttribute('value', index + 1);
        option.innerHTML = sheetName;
        sheetSelector.appendChild(option);
      });
    }
    function renderQuestions(questions) {
      
      questions.forEach((question) => {
        question_Shuffle(question);
        if (question[idxPattern] >= 'A' && question[idxPattern] <= 'UX') {
          renderX_Question(question);



        }



      });
      timer.style.display = 'inline-block';
      comment = document.createElement('p');
      comment.setAttribute('id', 'comment');
      container.appendChild(comment);
      checknext = document.createElement('div');
      checknext.setAttribute('id', 'check-next');
      checknext.setAttribute('onclick', 'checkNext()');
      checknext.textContent = 'ãƒã‚§ãƒƒã‚¯';
      container.appendChild(checknext);
      //
      seikaiSu = 0;
      let divGrade = document.createElement('div');
      divGrade.setAttribute('class', 'totalGrade totalGradeNoDisplay');
      container.appendChild(divGrade);
      let div = document.createElement('div');
      let mondaisu = questions.filter(question => question[idxPattern] !== 'PX' && question[idxPattern] !== 'UX').length - 1;
      div.textContent = `å…¨å•é¡Œæ•°${mondaisu}å•ä¸­ã§`;
      divGrade.appendChild(div);





    }

    function question_Shuffle(question) {
      //
      if (question[idxPattern] === 'L' || question[idxPattern] === 'PX' || question[idxPattern] === 'UX') {
        return;
      }
      const shuffleArray = (array) => {
        const cloneArray = [...array]

        for (let i = cloneArray.length - 1; i >= 0; i--) {
          let rand = Math.floor(Math.random() * (i + 1))
          // é…åˆ—ã®è¦ç´ ã®é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆã‚‹
          let tmpStorage = cloneArray[i]
          cloneArray[i] = cloneArray[rand]
          cloneArray[rand] = tmpStorage
        }

        return cloneArray
      }
      //
      let i = 0;
      let inTab = [];
      let outTab = [];
      for (i = 0; i < question.length; i++) {
        if (question[idxSpan + i] == '') {
          break;
        }
        inTab[i] = question[idxSpan + i];
      }
      outTab = shuffleArray(inTab);
      for (i = 0; i < outTab.length; i++) {
        question[idxSpan + i] = outTab[i];
      }



    }






    // 
    function renderX_Question(question) {
      startTime = 0;
      container = document.getElementById('container');
      let div, p, span, divContent, button, small, divSpanGroup;
      divContent = document.createElement('div');
      divContent.setAttribute('class', 'dataContent');
      container.appendChild(divContent);
      
      p = document.createElement('p');
      p.textContent = `å•é¡Œç•ªå·ï¼š${question[idxNo]}/${questions.length - 1}`;
      p.setAttribute('class', 'question-no');
      divContent.appendChild(p);

      //

      p = document.createElement('p');
      p.textContent = question[idxPinyin];
      if (question[idxPattern] === 'D' || question[idxPattern] === 'H' || question[idxPattern] === 'I' || question[idxPattern] === 'Q' || question[idxPattern] === 'PX' || question[idxPattern] === 'UX') {
        p.setAttribute('class', 'pinyin');

      } else {
        p.setAttribute('class', 'pinyin pinyinNoDisplay');

      }
      divContent.appendChild(p);
      //
      p = document.createElement('p');
      let wHanyu;
      wHanyu = setHanyuBunkai(question[idxHanyu]);
      p.textContent = wHanyu;
      if (question[idxPattern] === 'E' || question[idxPattern] === 'H' || question[idxPattern] === 'I' || question[idxPattern] === 'N'  || question[idxPattern] === 'Q' || question[idxPattern] === 'T' || question[idxPattern] === 'UX') {

        p.setAttribute('class', 'hanyu');
        if (question[idxPattern] === 'N') {
          let wHanyu2 = setHanyuBunkai2(question[idxHanyu]);
          p.setAttribute('onclick', `speakDataNpatern("${wHanyu2}")`);
        } else {
          p.setAttribute('onclick', 'speakData(this)');
        }
       
        divContent.appendChild(p);

      } else {
        p.setAttribute('class', 'hanyu hanyuNoDisplay');
        p.setAttribute('onclick', 'speakData(this)');
        divContent.appendChild(p);

      }
      //
      let divJapanese;
      divJapanese = document.createElement('div');
      divJapanese.setAttribute('class', 'japaneseGroupX');
      divContent.appendChild(divJapanese);

      p = document.createElement('p');

      [kNihongo1, kNihongo2] = fncNihongoBunnkai(question[idxRiyu]);

      p.textContent = kNihongo1;
      if (question[idxPattern] === 'A' || question[idxPattern] === 'F' || question[idxPattern] === 'H' || question[idxPattern] === 'I' || question[idxPattern] === 'J' || question[idxPattern] === 'K' || question[idxPattern] === 'N' || question[idxPattern] === 'PX' || question[idxPattern] === 'Q' || question[idxPattern] === 'R' || question[idxPattern] === 'S' || question[idxPattern] === 'T' || question[idxPattern] === 'UX') {
        p.setAttribute('class', 'japanese');
        divJapanese.appendChild(p);

      } else {
        p.setAttribute('class', 'japanese japaneseNoDisplay');
        divJapanese.appendChild(p);

      }
      p = document.createElement('p');

      p.setAttribute('class', 'japaneseKnone japaneseGroup');
      if (question[idxPattern] === 'K') {
        p.textContent = ' / ' + kNihongo2;

      } else {
        p.textContent = ' ';
      }

      divJapanese.appendChild(p);


      //
      if (question[idxPattern] === 'C') {
        p = document.createElement('p');
        p.textContent = 'ãƒ”ãƒ³ã‚¤ãƒ³ã‚’æ¼¢å­—ã«ç›´ã—ã¦ä¸¦ã¹æ›¿ãˆæ­£ã—ã„æ–‡ç« ã«ã—ã¦ãã ã•ã„ã€‚';
        p.setAttribute('class', 'pFontSize');
        divContent.appendChild(p);
        p = document.createElement('p');
        p.setAttribute('class', 'lPatern lPaternNoDisplay');
        p.textContent = '';
        divContent.appendChild(p);

      } else if (question[idxPattern] === 'L') {

        p = document.createElement('p');
        p.textContent = 'è³ªå•ã•ã‚ŒãŸã“ã¨ã«éŸ³å£°ã§å›ç­”ã—ã¦ãã ã•ã„ã€‚';
        p.setAttribute('class', 'pFontSize');
        divContent.appendChild(p);

        p = document.createElement('p');
        p.setAttribute('class', 'lPatern lPaternNoDisplay');
        //
        span = document.createElement('span');

        span.textContent = 'æ¨¡èŒƒå›ç­”:';
        span.setAttribute('onclick', 'speakData(this)');
        span.setAttribute('class', 'lPaternAnswer');
        p.appendChild(span);

        for (let i = idxSpan; i < question.length; i++) {
          span = document.createElement('span');
          let lKaitou1, lKaitou2;
          [lKaitou1, lKaitou2] = bunkaiLKaitou(question[i]);
          span.textContent = lKaitou1 + " ";
          span.setAttribute('onclick', 'speakData(this)');
          span.setAttribute('class', 'lPaternAnswer');
          p.appendChild(span);

        }
        divContent.appendChild(p);

      } else if (question[idxPattern] === 'I' || question[idxPattern] === 'J') {
        p = document.createElement('p');
        p.textContent = 'å•é¡Œã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç™ºéŸ³ãŒåŒã˜ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚';
        p.setAttribute('class', 'pFontSize');
        divContent.appendChild(p);
        p = document.createElement('p');
        p.setAttribute('class', 'lPatern lPaternNoDisplay');
        p.textContent = '';
        divContent.appendChild(p);
      } else if (question[idxPattern] === 'O' || question[idxPattern] === 'P' || question[idxPattern] === 'Q') {
        p = document.createElement('p');
        p.textContent = 'å•é¡Œã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€å•ã„ã«å¯¾ã™ã‚‹å›ç­”ãŒæœ€ã‚‚é©ã—ã¦ã„ã‚‹ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚';
        p.setAttribute('class', 'pFontSize');
        divContent.appendChild(p);
        p = document.createElement('p');
        p.setAttribute('class', 'lPatern lPaternNoDisplay');
        p.textContent = '';
        divContent.appendChild(p);

      } else {
        p = document.createElement('p');
        p.textContent = '';
        p.setAttribute('class', 'pFontSize pFontSizeNoDisplay');
        divContent.appendChild(p);
        p = document.createElement('p');
        p.setAttribute('class', 'lPatern lPaternNoDisplay');
        p.textContent = '';
        divContent.appendChild(p);

      }

      //
      if (question[idxPattern] === 'B' || question[idxPattern] === 'G' || question[idxPattern] === 'H' || question[idxPattern] === 'L' || question[idxPattern] === 'M'ã€€|| question[idxPattern] === 'O' || question[idxPattern] === 'PX' || question[idxPattern] === 'P' || question[idxPattern] === 'Q') {
        divSpeak = document.createElement('div');
        divSpeak.textContent = 'Speak';
        divSpeak.setAttribute('onclick', 'speakData2()');
        divSpeak.setAttribute('class', 'divSpeak');
        divContent.appendChild(divSpeak);
      }
      // 
      divSpanGroup = document.createElement('div');
      div = document.createElement('div');
      div.setAttribute('class', 'answer member');
      divSpanGroup.appendChild(div);
      span = document.createElement('span');

      if (question[idxPattern] === 'C' || question[idxPattern] === 'F' || question[idxPattern] === 'G' || question[idxPattern] === 'H' || question[idxPattern] === 'L' || question[idxPattern] === 'PX' || question[idxPattern] === 'UX') {
        span.textContent = '';

      } else {
        span.textContent = 'å›ç­”ï¼šã€€';

      }
      span.setAttribute('class', 'draggroup');
      div.appendChild(span);
      // 
      div = document.createElement('div');
      div.setAttribute('class', 'question member');
      divSpanGroup.appendChild(div);
      span = document.createElement('span');
      span.setAttribute('class', 'draggroup');
      if (question[idxPattern] === 'F' || question[idxPattern] === 'G' || question[idxPattern] === 'H' || question[idxPattern] === 'L' || question[idxPattern] === 'PX' || question[idxPattern] === 'UX') {

        span.textContent = '';
      } else {
        span.textContent = 'å•é¡Œï¼šã€€';
        div.appendChild(span);
        let i;
        let spanX = 0;
        for (i = idxSpan; i < question.length; i++) {
          if (question[i] !== '') {
            span = document.createElement('span');
            span.setAttribute('class', 'draggroup');
            if (question[idxPattern] === 'I' || question[idxPattern] === 'J' || question[idxPattern] === 'K' || question[idxPattern] === 'O' || question[idxPattern] === 'P' || question[idxPattern] === 'Q') {
              spanX++;
              span.setAttribute('class', `spanBack${spanX}`);


            }
            span.textContent = question[i];
            span.setAttribute('onclick', 'speakDataX(this)')
            span.setAttribute('onmousedown', 'speakData(this)')
            div.appendChild(span);

          }

        }

      }
      divContent.appendChild(divSpanGroup);
      //  2024-03-19 add ãƒ‘ã‚¿ãƒ¼ãƒ³I,J,Kä»¥å¤–ã«ç„¡ç†ã‚„ã‚Šä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¹ã‚’ä»˜åŠ ã™ã‚‹ã€‚
      if (question[idxPattern] !== 'I' && question[idxPattern] !== 'J' && question[idxPattern] !== 'K' && question[idxPattern] !== 'O' && question[idxPattern] !== 'P' && question[idxPattern] !== 'Q') {
        p = document.createElement('p');
        p.setAttribute('class', 'spanBack1 spanBack2 spanBack3 spanBack4 spanBackNone');
        divContent.appendChild(p);
      }

      // 
      if (question[idxPattern] === 'C' || question[idxPattern] === 'F' || question[idxPattern] === 'G') {
        div = document.createElement('div');
        div.textContent = 'ä¸­å›½èªå…¥åŠ›';
        divContent.appendChild(div);

        input = document.createElement('input');

        input.setAttribute('class', 'input');
        input.setAttribute('maxlength', '40');
        input.setAttribute('size', '40');
        div.appendChild(input);
        //
        div = document.createElement('div');
        div.setAttribute('class', 'statsu statusNodisplay');
        divContent.appendChild(div);
        //


      } else if (question[idxPattern] === 'H' || question[idxPattern] === 'L') {
        micBtn = document.createElement('button');
        micBtn.setAttribute('class', 'onseiStart');
        micBtn.textContent = 'éŸ³å£°å…¥åŠ›';
        micBtn.style.display = 'inline-block';
        micBtn.setAttribute('onclick', 'fncOnseiNyuryoku(this)');
        divContent.appendChild(micBtn);
        small = document.createElement('small');
        small.setAttribute('class', 'status');

        divContent.appendChild(small);
        div = document.createElement('div');
        div.setAttribute('class', 'show_result');
        divContent.appendChild(div);

        // show_result = document.querySelector('.show_result');
        div = document.createElement('div');

        div.setAttribute('class', 'input inputNodisplay');
        divContent.appendChild(div);


      } else {
        //
        div = document.createElement('div');
        div.textContent = '';
        divContent.appendChild(div);
        //
        div = document.createElement('div');
        div.setAttribute('class', 'statsu statusNodisplay');
        divContent.appendChild(div);
        //
        div = document.createElement('div');

        div.setAttribute('class', 'input inputNodisplay');
        divContent.appendChild(div);
      }


    }
    // ã‚¿ã‚¤ãƒ—C,G,Aã€€ä¸­å›½èªåˆ†è§£
    function setHanyuBunkai(hanyuString) {

      const cstSlash = "/";
      let wHanyu1;

      let wHanyu = hanyuString.split(cstSlash);
      wHanyu1 = wHanyu[0];
      return wHanyu1;

    }
    // ã‚¿ã‚¤ãƒ—Nã€€ä¸­å›½èªåˆ†è§£ /ä»¥ä¸‹ã®ä¸­å›½èªæ–‡å­—åˆ—ã‚’è¿”ã™
    function setHanyuBunkai2(hanyuString) {
      const cstSlash = "/";
      
      let wHanyu2;
      let wHanyu = hanyuString.split(cstSlash);
      
      wHanyu2 = wHanyu[1];
      return  wHanyu2;

    }
    // ã‚¿ã‚¤ãƒ—Kã€€æ—¥æœ¬èªåˆ†è§£
    function fncNihongoBunnkai(nihongoString) {
      const cstSlash = "/";
      let wNihongo1;
      let wNihongo2;
      let wNihongo = nihongoString.split(cstSlash);
      wNihongo1 = wNihongo[0];
      wNihongo2 = wNihongo[1];
      return [wNihongo1, wNihongo2];

    }


    //
    //
    function bunkaiLKaitou(lKaitou) {
      let lKaitou1, lKaitou2;
      const cstSlash = "/";

      let wKaitou = lKaitou.split(cstSlash);
      if (wKaitou.length === 1) {
        lKaitou1 = wKaitou[0];
        lKaitou2 = 'å¥½ï¼èµğŸ‘';
      } else {
        lKaitou1 = wKaitou[0];
        lKaitou2 = wKaitou[1];

      }

      return [lKaitou1, lKaitou2];
    }
    function checkNext() {
      if (questions[cssIndex][idxPattern] === 'PX' || questions[cssIndex][idxPattern] === 'UX') {
        swButton = true;
      }
      if (swButton) {
        swButton = false;
        checknext.textContent = 'ãƒã‚§ãƒƒã‚¯';
        const hanyuGroup = document.querySelectorAll('.hanyu');
        const pinyinGroup = document.querySelectorAll('.pinyin');
        const japaneseGroup = document.querySelectorAll('.japanese');

        //
        const comment = document.getElementById('comment');
        comment.textContent = "";
        var classElement = document.getElementsByClassName('dataContent');
        cssIndex++;
        if (cssIndex === classElement.length) {
          iniCSSSet2();
          const totalGrade = document.querySelector('.totalGrade');
          totalGrade.classList.add('totalGradeDisplay');
          totalGrade.classList.remove('totalGradeNoDisplay');
          let div = document.createElement('div');
          let mondaisu = questions.filter(question => question[idxPattern] !== 'PX' && question[idxPattern] !== 'UX').length - 1;
          let ritsu = seikaiSu * 100 / mondaisu;
          div.textContent = `æ­£ç­”æ•°ã¯${seikaiSu}, æ­£ç­”ç‡ã¯${ritsu.toFixed(1)}ã§ã—ãŸã€‚`;
          totalGrade.appendChild(div);
          //
          if (startTime > 0) {
            endTime = Date.now(); // çµ‚äº†æ™‚é–“
            let syoriTime = endTime - startTime;
            console.log(syoriTime);
            let syoriMinute = Math.floor(syoriTime / 60000);
            if (syoriMinute < 1) {
              syoriMinute = 0;
            }
            let syoriSecond = syoriTime % 60000;
            syoriSecond = syoriSecond / 1000;

            div = document.createElement('div');
            div.textContent = `å‡¦ç†æ™‚é–“ã¯${syoriMinute}åˆ†${syoriSecond.toFixed(1)}ç§’ã§ã—ãŸã€‚`;
            totalGrade.appendChild(div);

          }


          if (seikaiSu === mondaisu) {
            div = document.createElement('div');
            div.textContent = 'æ­å–œæ­å–œ!!';
            div.setAttribute('id', 'baiFen');
            totalGrade.appendChild(div);
            speakData(div);
          }
          div = document.createElement('div');
          div.setAttribute('id', 'reTry');
          div.setAttribute('onclick', 'setReTry()');
          div.textContent = 'ã‚¯ãƒªãƒƒã‚¯ã™ã‚Œã°æœ€åˆã‹ã‚‰å†åº¦æŒ‘æˆ¦ã§ãã¾ã™ã€‚';
          totalGrade.appendChild(div);

          cssIndex = 0;
          //

          //
          return;
        }

        for (let i = 0; i < classElement.length; i++) {
          if (i === cssIndex) {
            classElement[i].classList.add("dataDisplay");
            classElement[i].classList.remove("dataNone");

          } else {
            classElement[i].classList.add("dataNone");
            classElement[i].classList.remove("dataDisplay");

          }
          if (hanyuGroup[i].classList.contains('hanyuDisplay')) {
            hanyuGroup[i].classList.remove('hanyuDisplay');
            hanyuGroup[i].classList.add('hanyuNoDisplay');
          }
          if (pinyinGroup[i].classList.contains('pinyinDisplay')) {
            pinyinGroup[i].classList.remove('pinyinDisplay');
            pinyinGroup[i].classList.add('pinyinNoDisplay');
          }
          if (japaneseGroup[i].classList.contains('japaneseDisplay')) {
            japaneseGroup[i].classList.remove('japaneseDisplay');
            japaneseGroup[i].classList.add('japaneseNoDisplay');
          }


        }
        spanSortable();

      } else {
        swButton = true;
        checknext.textContent = 'æ¬¡ã®å•é¡Œ';
        const comment = document.getElementById('comment');
        const japaneseKnoneGroup = document.querySelectorAll('.japaneseGroup');
        const hanyuGroup = document.querySelectorAll('.hanyu');
        const pinyinGroup = document.querySelectorAll('.pinyin');
        const spanBack1 = document.querySelectorAll('.spanBack1');
        const spanBack2 = document.querySelectorAll('.spanBack2');
        const spanBack3 = document.querySelectorAll('.spanBack3');
        const spanBack4 = document.querySelectorAll('.spanBack4');
        const lPaterns = document.querySelectorAll('.lPatern');
        if (japaneseKnoneGroup[cssIndex].classList.contains('japaneseKnone')) {

          japaneseKnoneGroup[cssIndex].classList.remove('japaneseKnone');
          japaneseKnoneGroup[cssIndex].classList.add('japaneseKBlock');
        }

        if (questions[cssIndex][idxPattern] !== 'E') {
          hanyuGroup[cssIndex].classList.add('hanyuDisplay');
          hanyuGroup[cssIndex].classList.remove('hanyuNoDisplay');
        }
        if (questions[cssIndex][idxPattern] === 'L') {

          lPaterns[cssIndex].classList.remove('lPaternNoDisplay');

        }
        if (questions[cssIndex][idxPattern] !== 'D') {
          pinyinGroup[cssIndex].classList.add('pinyinDisplay');
          pinyinGroup[cssIndex].classList.remove('pinyinNoDisplay');

        }
        if (questions[cssIndex][idxPattern] === 'I' || questions[cssIndex][idxPattern] === 'J' || questions[cssIndex][idxPattern] === 'K' || questions[cssIndex][idxPattern] === 'O' || questions[cssIndex][idxPattern] === 'P' || questions[cssIndex][idxPattern] === 'Q') {
          //
          spanBack1[cssIndex].classList.add('spanBackCansel');
          spanBack1[cssIndex].classList.remove('spacBack1');
          //
          spanBack2[cssIndex].classList.add('spanBackCansel');
          spanBack2[cssIndex].classList.remove('spacBack2');
          //
          spanBack3[cssIndex].classList.add('spanBackCansel');
          spanBack3[cssIndex].classList.remove('spacBack3');
          //
          spanBack4[cssIndex].classList.add('spanBackCansel');
          spanBack4[cssIndex].classList.remove('spacBack4');

        }
        const hanyu = questions[cssIndex][idxHanyu];
        if (questions[cssIndex][idxPattern] === 'N') {
          hanyuGroup[cssIndex].innerHTML =hanyu;
          
        }
        const pinyin = questions[cssIndex][idxPinyin];
        console.log(hanyu);
        //
        if (questions[cssIndex][idxPattern] !== 'A') {
          const japaneseGroup = document.querySelectorAll('.japanese');
          japaneseGroup[cssIndex].classList.add('japaneseDisplay');
          japaneseGroup[cssIndex].classList.remove('japaneseNoDisplay');

        }
        if (questions[cssIndex][idxPattern] === 'C' || questions[cssIndex][idxPattern] === 'F' || questions[cssIndex][idxPattern] === 'G') {
          const inputGroup = document.querySelectorAll('.input');
          let inputHanyu = inputGroup[cssIndex];
          //
          if (questions[cssIndex][idxPattern] === 'F') {
            if (pattertnF_Judge(inputHanyu.value, cssIndex)) {
              seikaiSu++;
              comment.textContent = 'å¥½ï¼èµğŸ‘';
            } else {
              comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';

            }
            speakData(comment);

          } else if (questions[cssIndex][idxPattern] === 'C' || questions[cssIndex][idxPattern] === 'G') {
            if (patternCorG_Judge(inputHanyu.value, cssIndex)) {
              seikaiSu++;
              comment.textContent = 'å¥½ï¼èµğŸ‘';
            } else {
              comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';

            }
            speakData(comment);
          } else {

            console.log(`patern=${questions[cssIndex][idxPattern]}`);
            console.log(`inputHanyu=${inputHanyu.value}`);
            console.log(`hanyu=${hanyu}`);
            if (inputHanyu.value === hanyu) {
              seikaiSu++;
              comment.textContent = 'å¥½ï¼èµğŸ‘';
            } else {
              comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';

            }
            speakData(comment);

          }

          //
        } else if (questions[cssIndex][idxPattern] === 'H') {
          recognition.stop();
          let [whanyu, whAnswer] = hanyuHosei(hanyu, hAnswer);
          if (whanyu === whAnswer) {
            seikaiSu++;
            comment.textContent = 'å¥½ï¼èµğŸ‘';
          } else {
            comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';

          }
          speakData(comment);

        } else if (questions[cssIndex][idxPattern] === 'L') {
          recognition.stop();
          lPaternJudge(hAnswer, cssIndex)






        } else {
          const answers = document.querySelectorAll('.answer');

          span = answers[cssIndex].getElementsByTagName('span');

          let answerString = '';
          let i;
          for (i = 1; i < span.length; i++) {
            answerString = answerString + setHanyuBunkai(span[i].textContent);

          }
          console.log(answerString);
          if (questions[cssIndex][idxPattern] === 'N') {
            if (patternNCheck(answerString, hanyu)) {
              seikaiSu++;
              comment.textContent = 'å¥½ï¼èµğŸ‘';
            } else {
              comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';

            }
            
            speakData(comment);
          } else {
            let correctAnswer;
            if (questions[cssIndex][idxPattern] === 'O' || questions[cssIndex][idxPattern] === 'P' || questions[cssIndex][idxPattern] === 'Q'ã€€|| questions[cssIndex][idxPattern] === 'R' || questions[cssIndex][idxPattern] === 'T') {
              
              saveQuestions = structuredClone(sheetDatas[sheetIndex2 + 1]);
              correctAnswer = saveQuestions[cssIndex][5];
             
            
            } else if (questions[cssIndex][idxPattern] === 'E') {
              correctAnswer = pinyin;

            } else {
              correctAnswer = hanyu.split('/');
            }
            console.log(`correctAnswer=${correctAnswer}`);
            console.log(`answerString=${answerString}`);
            // if (answerString === correctAnswer) {
            if (correctAnswer.includes(answerString)) {

              comment.textContent = 'å¥½ï¼èµğŸ‘';
              seikaiSu++;
              console.log('OK');
            } else {
              comment.textContent = 'é”™Ã—ã€€å†åŠ æ²¹ï¼ï¼';
              console.log('wrong');
            }
            speakData(comment);
          }
          //
        }

      }
      // Nãƒ‘ã‚¿ãƒ¼ãƒ³ã€€åˆ¤å®š
      // hanyuParts1ã®å”çˆ¶åˆ—ã®ä¸­ã®'()'ã‚’answerStringã§ç½®ãæ›ãˆãŸã„
      function patternNCheck(answerString, hanyu) {
        
        let hanyuParts = hanyu.split('/');
        let hanyuParts1 = hanyuParts[0];
        let hanyuParts2 = hanyuParts[1];
        
        // Replace '()' with answerString in hanyuParts1
        let hanyuParts3 = hanyuParts1.replace('()', answerString);
        
        
          if (hanyuParts2 === hanyuParts3) {
            return true;
           
          } else {
            return false;
          }
        }
       
      }
      // Lãƒ‘ã‚¿ãƒ¼ãƒ³ã€€åˆ¤å®š
      function lPaternJudge(hAnswer, cssIndex) {
        recognition.stop();

        let matchOn = false;
        let lKaitou1;
        let lKaitou2;
        for (let i = idxSpan; i < questions[cssIndex].length; i++) {
          if (questions[cssIndex][i] !== '') {
            console.log(`Lãƒ‘ã‚¿ãƒ¼ãƒ³ã€€hAnswer=${hAnswer}`);

            [lKaitou1, lKaitou2] = bunkaiLKaitou(questions[cssIndex][i])
            let wHanyu;
            let wHanswer;
            [wHanyu, wHanswer] = hanyuHosei(lKaitou1, hAnswer)
            console.log(`Lãƒ‘ã‚¿ãƒ¼ãƒ³ã€€Fåˆ—=${lKaitou1}`);
            if (wHanyu === wHanswer) {
              matchOn = true;
              break;

            }

          }
        }

        if (matchOn) {
          seikaiSu++;
          comment.textContent = lKaitou2;
          speakData(comment);



        } else {
          comment.textContent = 'ä½ çš„å›ç­”ä¸ä¸€æ ·ã€‚';

          speakData(comment);

        }




      }
      // Hãƒ‘ã‚¿ãƒ¼ãƒ³ã€€ï¼Ÿã€€ã€‚è£œæ­£
      function hanyuHosei(hanyu, hAnswer) {
        console.log(`hanyu=${hanyu}`);
        console.log(`hAnswer=${hAnswer}`);
        let whanyu = hanyu;

        let whAnswer = hAnswer;

        let whanyu1 = whanyu.split(cstKanma);
        let whanyu2 = whanyu1.join('');

        let whanyu3 = whanyu2.split(constWenhao);
        let whanyu4 = whanyu3.join('');

        let whanyu5 = whanyu4.split(constKuten);
        whanyu = whanyu5.join('');
        //
        let whAnswer1 = whAnswer.split(cstKanma);
        let whAnswer2 = whAnswer1.join('');

        let whAnswer3 = whAnswer2.split(constWenhao);
        let whAnswer4 = whAnswer3.join('');

        let whAnswer5 = whAnswer4.split(constKuten);
        whAnswer = whAnswer5.join('');


        return [whanyu, whAnswer];


      }
      // 
      function pattertnF_Judge(inputHanyu, cssIndex) {
        let matchOn = true;
        let hanyu = questions[cssIndex][idxHanyu];
        if (inputHanyu === hanyu) {
          return matchOn;
        }
        matchOn = false;
        for (let i = idxSpan; i < questions[cssIndex].length; i++) {
          if (questions[cssIndex][i] !== '') {
            if (inputHanyu === questions[cssIndex][i]) {
              matchOn = true;
              return matchOn;


            }

          }
        }
        matchOn = false;
        return matchOn;
      }
      // 
      function patternCorG_Judge(inputHanyu, cssIndex) {
        const hanyu = questions[cssIndex][idxHanyu];
        const hanyuParts = hanyu.split('/');

        return hanyuParts.includes(inputHanyu);
      }
      //
      function setReTry() {
        const totalGrade = document.querySelector('.totalGrade');
        totalGrade.classList.add('totalGradeNoDisplay');
        totalGrade.classList.remove('totalGradeDisplay');
        container.remove();
        container = document.createElement('div');
        container.setAttribute('id', 'container');
        main.appendChild(container);

        renderQuestions(questions);
        iniCSSSet();
        cssIndex = 0;
        swButton = false;

      }
      //
      function spanSortable() {
        if (osAndroid) {
          return;
        }
        let answerGroup = document.querySelectorAll('.answer');;
        let questionGroup = document.querySelectorAll('.question');;
        let answerSpans = answerGroup[cssIndex];
        let questionSpans = questionGroup[cssIndex];
        new Sortable(answerSpans, {
          group: 'shared', // set both lists to same group
          animation: 150
        });

        new Sortable(questionSpans, {
          group: 'shared',
          animation: 150
        });


      }




      // ã‚¤ãƒ‹ã‚·ãƒ£ãƒ«ã€€æ›¸ãã‚·ãƒ¼ãƒˆç”¨ã®CSS ã‚»ãƒƒãƒˆã€€ã€€æœ€åˆã®å•é¡Œã«ç§»ã‚‹
      function iniCSSSet() {
        cssIndex = 0;
        var classElement = document.getElementsByClassName('dataContent');
        classElement[0].classList.add("dataDisplay");
        if (classElement[0].classList.contains('dataNone')) {
          classElement[i].classList.remove('dataNone');
        }
        for (let i = 1; i < classElement.length; i++) {
          classElement[i].classList.add("dataNone");
        }
        spanSortable();


      }
      // ã‚¤ãƒ‹ã‚·ãƒ£ãƒ«ã€€æ›¸ãã‚·ãƒ¼ãƒˆç”¨ã®CSS ã‚»ãƒƒãƒˆã€€ã€€æœ€åˆã®å•é¡Œã«ç§»ã‚‹
      function iniCSSSet2() {
        cssIndex = 0;
        var classElement = document.getElementsByClassName('dataContent');

        for (let i = 0; i < classElement.length; i++) {
          classElement[i].classList.add("dataNone");
          if (classElement[i].classList.contains('ditaDisplay')) {
            classElement[i].classElement.remove('dataDisplay');
          }
        }
        spanSortable();


      }

  </script>
</body>

</html>